[
  {
    "Id": "582225",
    "ThreadId": "250137",
    "Html": "\r\n<p>Hi Guys,<br>\r\nI'm a pretty new HTML Agility Pack user, only played around with it last few days<br>\r\ntrying to scrape some business info but I can't get it to work as I want.</p>\r\n<p>Instead of trying to explain in writing, I better show you my code below.</p>\r\n<p>The result I get is this, different company name, but all with same phone and address:<br>\r\n&nbsp;&nbsp; Le Soleil Spa, 403-766-9231, 2359 Banff Trail NW, Calgary, AB, T2M4L2\r\n<br>\r\n&nbsp;&nbsp; Spa Ritual The, 403-766-9231, 2359 Banff Trail NW, Calgary, AB, T2M4L2\r\n<br>\r\n&nbsp;&nbsp; Sante Spa, 403-766-9231, 2359 Banff Trail NW, Calgary, AB, T2M4L2 <br>\r\n<br>\r\nAnd this is what I am expecting to get:<br>\r\n&nbsp;&nbsp; Le Soleil Spa, 403-766-9231, 2359 Banff Trail NW, Calgary, AB, T2M4L2\r\n<br>\r\n&nbsp;&nbsp; Spa Ritual The, 403-766-9231, 106 Crowfoot Terr NW, Calgary, AB, T3G4J8\r\n<br>\r\n&nbsp;&nbsp; Sante Spa, 403-766-9231, 240-508 24 Ave SW, Calgary, AB, T2S0K4</p>\r\n<p>I hope someone can show me what I done wrong, since I almost pulled my hair off already while trying to figure it out ...<br>\r\nIf I'm on a totally wrong road here, please show me some sample (VB) code that will point me the right way ...</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>  <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Function</span> CleanItem(<span style=\"color:blue\">ByVal</span> sRecord <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>)\r\n    <span style=\"color:blue\">Dim</span> replaceUnwanted <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = <span style=\"color:#a31515\">&quot;&quot;</span>\r\n    replaceUnwanted = sRecord.Replace(<span style=\"color:#a31515\">&quot;&amp;amp;&quot;</span>, <span style=\"color:#a31515\">&quot;&amp;&quot;</span>) <span style=\"color:green\">'</span>\r\n    replaceUnwanted = replaceUnwanted.Replace(<span style=\"color:#a31515\">&quot;&amp;#39;&quot;</span>, <span style=\"color:#a31515\">&quot;'&quot;</span>)\r\n    <span style=\"color:blue\">Return</span> replaceUnwanted\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span>\r\n\r\n\r\n  <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> do_scrape()\r\n    <span style=\"color:green\">' This is the URL I'm testing to scrape info from</span>\r\n    <span style=\"color:green\">'  http://www.yellowpages.ca/search/si/1/Estheticians/Calgary&#43;AB</span>\r\n\r\n    <span style=\"color:blue\">Dim</span> content <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = <span style=\"color:#a31515\">&quot;&quot;</span>\r\n    <span style=\"color:blue\">Dim</span> address <span style=\"color:blue\">As</span> HtmlAgilityPack.HtmlNode\r\n    <span style=\"color:blue\">Dim</span> phone <span style=\"color:blue\">As</span> HtmlAgilityPack.HtmlNode\r\n\r\n    <span style=\"color:blue\">Dim</span> doc <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> HtmlAgilityPack.HtmlDocument()\r\n    doc.Load(WB1.DocumentStream)\r\n    <span style=\"color:blue\">Dim</span> hnc <span style=\"color:blue\">As</span> HtmlAgilityPack.HtmlNodeCollection = doc.DocumentNode.SelectNodes(<span style=\"color:#a31515\">&quot;//span[@class='listingTitle']&quot;</span>)\r\n\r\n    <span style=\"color:blue\">For</span> <span style=\"color:blue\">Each</span> link <span style=\"color:blue\">As</span> HtmlAgilityPack.HtmlNode <span style=\"color:blue\">In</span> hnc\r\n      phone = link.SelectSingleNode(<span style=\"color:#a31515\">&quot;//h4[@class='phoneLink']/a&quot;</span>)\r\n      address = link.SelectSingleNode(<span style=\"color:#a31515\">&quot;//div[@class='address']&quot;</span>)\r\n\r\n      content &amp;= CleanItem(link.InnerText) &amp; <span style=\"color:#a31515\">&quot;, &quot;</span> &amp; Trim(phone.InnerText) &amp; <span style=\"color:#a31515\">&quot;, &quot;</span> &amp; Trim(address.InnerText) &amp; vbNewLine\r\n    <span style=\"color:blue\">Next</span>\r\n\r\n    txtResult.Text = content\r\n\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2011-03-17T10:30:54.237-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "582828",
    "ThreadId": "250137",
    "Html": "<p>Try this instead:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>HtmlNodeCollection nodes = htmlDocument.DocumentNode.SelectNodes(<span style=\"color: #a31515;\">\"//div[@class='listingDetail']\"</span>);</pre>\r\n</div>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">foreach</span>(HtmlNode node <span style=\"color: blue;\">in</span> nodes)\r\n{\r\n    HtmlNode phone = node.SelectSingleNode(<span style=\"color: #a31515;\">\"./div/h4[@class='phoneLink']/a\"</span>);\r\n    HtmlNode address = node.SelectSingleNode(<span style=\"color: #a31515;\">\"./div[@class='listingDetailLHS']/div[@class='address']\"</span>);\r\n}\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2011-03-18T12:39:09.967-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "583221",
    "ThreadId": "250137",
    "Html": "<p>Thanx roux!</p>\r\n<p>I got it working like a charm now :)</p>",
    "PostedDate": "2011-03-20T01:52:08.597-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]