[
  {
    "Id": "1071465",
    "ThreadId": "450844",
    "Html": "HTML I'm scraping is below. It contains a post and 2 replies:<br />\n<pre><code>&lt;div class=&quot;share_buttons noprint&quot;&gt;...&lt;/div&gt;\n\n&lt;strong&gt;Dan&lt;/strong&gt; Says:&lt;br/&gt;\n&lt;span class=&quot;small soft&quot;&gt;&lt;time datetime=&quot;2009-10-05T02:27:38Z&quot;&gt;Sun, Oct 04 '09, 7:27 PM&lt;/time&gt;&lt;/span&gt;\n&lt;div class=&quot;quote_top&quot;&gt;&amp;nbsp;&lt;/div&gt;\n&lt;div class=&quot;quote_item&quot;&gt;Hello all, this is my original post.&lt;br/&gt;&lt;/div&gt;\n\n&lt;form class=&quot;action_heading noprint&quot;&gt;\n&lt;strong&gt;Page&lt;/strong&gt; \n...\n&lt;/form&gt;\n\n&lt;div class=&quot;post_number&quot; id=&quot;r_140626&quot;&gt;1&lt;/div&gt;\n&lt;strong&gt;AnnieMae&lt;/strong&gt; Says:&lt;br/&gt;\n&lt;span class=&quot;small soft&quot;&gt;&lt;time datetime=&quot;2009-10-05T02:30:27Z&quot;&gt;Sun, Oct 04 '09, 7:30 PM&lt;/time&gt;&lt;/span&gt;\n&lt;div class=&quot;quote_top clear_float&quot;&gt;&amp;nbsp;&lt;/div&gt;\n&lt;div class=&quot;quote_item&quot;&gt;What do you think of it?&lt;br/&gt;&lt;/div&gt;\n\n&lt;div class=&quot;post_number&quot; id=&quot;r_140627&quot;&gt;2&lt;/div&gt;\n&lt;strong&gt;Thomas77&lt;/strong&gt; Says:&lt;br/&gt;\n&lt;span class=&quot;small soft&quot;&gt;&lt;time datetime=&quot;2009-10-05T02:32:32Z&quot;&gt;Sun, Oct 04 '09, 7:32 PM&lt;/time&gt;&lt;/span&gt;\n&lt;div class=&quot;quote_top clear_float&quot;&gt;&amp;nbsp;&lt;/div&gt;\n&lt;div class=&quot;quote_item&quot;&gt;Not really sure, can't see this pic?&lt;br/&gt;\n&lt;/div&gt;\n</code></pre>\n\nSo I've already figured out how to get the original post...<br />\n<pre><code>'get AUTHOR and DATE of original post\nDim divOriginalPostAuthor As HtmlNode = threadDoc.DocumentNode.SelectSingleNode(&quot;//div[@class='share_buttons noprint']/following-sibling::strong&quot;)\nDim divOriginalPostDate As HtmlNode = threadDoc.DocumentNode.SelectSingleNode(&quot;//div[@class='share_buttons noprint']/following-sibling::span/time&quot;)\n\nDim strDate As String = divOriginalPostDate.InnerText.Trim\nstrDate = strDate.Remove(0, InStr(strDate, &quot;, &quot;)).Trim\nstrDate = Replace(strDate, &quot;'&quot;, 20)\nDim strAuthor As String = (divOriginalPostAuthor.InnerText).Trim\ndtPosted = CDate(strDate)\ndivOriginalPostText = threadDoc.DocumentNode.SelectSingleNode(&quot;//div[@class='share_buttons noprint']/following-sibling::div[@class='quote_item']&quot;)\n</code></pre>\n\nNow I'm just trying to figure out how to get the replies...I was thinking of getting the current line position like this:<br />\n<pre><code>Dim currentNodePosition As Integer = threadDoc.DocumentNode.SelectSingleNode(&quot;//form[@class='action_heading noprint']&quot;).Line\n</code></pre>\n\nand then using that to iterate through the replies as I increment the current line position. The think that makes this tricky for me is that the replies don't have a &quot;container&quot; html element for me to collect at once.... Any ideas?<br />\n",
    "PostedDate": "2013-07-22T12:31:12.217-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1071844",
    "ThreadId": "450844",
    "Html": "just for the record, I figured this out and wanted to post the answer for anyone that needs it in the future.<br />\n<pre><code>'then get thread replies\nDim nodesPostNumber As HtmlNodeCollection = threadDoc.DocumentNode.SelectNodes(&quot;//form[@class='action_heading noprint']/following-sibling::div[contains(@id, 'r_')]&quot;)\nDim replies As New List(Of ThreadReply)\n\nIf Not nodesPostNumber Is Nothing Then\n\nDim intNumberOfReplies As Integer = nodesPostNumber.Count\nFor i = 1 To intNumberOfReplies\n    Dim nodeReplyDate As HtmlNode = threadDoc.DocumentNode.SelectSingleNode(&quot;//form[@class='action_heading noprint']/following-sibling::span[@class='small soft' and position()=&quot; + i.ToString + &quot;]&quot;)\n    Dim strXPathForDate As String = nodeReplyDate.XPath\n    Dim strReplyText As String = threadDoc.DocumentNode.SelectSingleNode(strXPathForDate + &quot;/following-sibling::div[@class='quote_item']&quot;).InnerHtml\n    strReplyText = Left(strReplyText, InStr(strReplyText, &quot;&lt;div class=&quot;&quot;noprint&quot;&quot;&quot;) - 1)\n    Dim strReplyAuthor As String = threadDoc.DocumentNode.SelectSingleNode(nodeReplyDate.XPath + &quot;/preceding-sibling::strong&quot;).InnerText\n    Dim strReplyDate As String = nodeReplyDate.InnerText.Trim\n    strReplyDate = strReplyDate.Remove(0, InStr(strReplyDate, &quot;, &quot;)).Trim\n    strReplyDate = Replace(strReplyDate, &quot;'&quot;, 20)\n    strReplyDate = Replace(strReplyDate, &quot;via mobile&quot;, &quot;&quot;)\n    Dim thisReply As New ThreadReply With {.Author = strReplyAuthor, .DatePosted = strReplyDate, .ThreadID = thisThread.ThreadID, .Text = strReplyText}\n    replies.Add(thisReply)\nNext\nEnd If</code></pre>\n\nSo, it's about &quot;grabbing&quot; the node that was used for 1 reply and using it in xpath again to make sure you only get replies that come AFTER the node you grabbed. I did this by using HTMLNode.Xpath which gives you the xpath string for any given HTMLAgilityPack.htmlnode and then adding &quot;/following-sibling&quot;.<br />\n",
    "PostedDate": "2013-07-23T10:07:14.497-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]