[
  {
    "Id": "567690",
    "ThreadId": "246426",
    "Html": "\r\n<p>Hello all!</p>\r\n<p>&nbsp;</p>\r\n<p>I'm new in using HAP and so far have been impressed (dear lord, no more regex no more!). I've done quite a few things but here's one I can't find how to do it.</p>\r\n<p>&nbsp;</p>\r\n<p>I have a table, with a row, which has another table within that row, and that row has the usual rows and cells, from which I need to extract the info. Of course the HTML is not mine. To clarify things, the HTML code goes like this:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre style=\"color:black\"><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">table</span> <span style=\"color:red\">cellpadding</span><span style=\"color:blue\">=</span><span style=\"color:blue\">0</span> <span style=\"color:red\">cellspacing</span><span style=\"color:blue\">=</span><span style=\"color:blue\">0</span> <span style=\"color:red\">border</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;0&quot;</span> <span style=\"color:red\">width</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;100%&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">table</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;border: solid #3972b9 1px&quot;</span> <span style=\"color:red\">cellspacing</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;0&quot;</span> <span style=\"color:red\">cellpadding</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;1&quot;</span> <span style=\"color:red\">width</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;100%&quot;&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tr</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align:center&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span>Indoor Hard<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align: right&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tr</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyleHead&quot;</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:red\">&amp;nbsp;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align:center&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyleHead&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span>Match Statistics<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyleHead&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:red\">&amp;nbsp;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tr</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span>70%    (74-31)<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align:center&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span>Match W/L<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align: right&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span>48%    (13-14)<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tr</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span>69%    (162-74)<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align:center&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span>Set W/L<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align: right&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span>47%    (30-34)<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tr</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span> <span style=\"color:red\">height</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;15&quot;</span><span style=\"color:blue\">&gt;</span>57%    (1312-1002)<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align:center&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span>Gm W/L<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;text-align: right&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;matchStyle&quot;</span><span style=\"color:blue\">&gt;</span>51%    (332-325)<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span></pre>\r\n<pre><span style=\"color:blue\">&nbsp;</span>  ...........................</pre>\r\n<pre>&lt;/table&gt;\r\n\r\n</pre>\r\n<pre>I'd need to extact each groups of 3 cells thathave the percentages and the name of it to create a list names with the corresponding values.</pre>\r\n<pre><br></pre>\r\n<pre>I first tried to do this:</pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre>            <span style=\"color:blue\">var</span> linksOnPage = <span style=\"color:blue\">from</span> lnks <span style=\"color:blue\">in</span> tempHtml.DocumentNode.Descendants(<span style=\"color:#a31515\">&quot;tr&quot;</span>)\r\n                              <span style=\"color:blue\">where</span> lnks.Name == <span style=\"color:#a31515\">&quot;td&quot;</span> &amp;&amp;\r\n                                    lnks.GetAttributeValue(<span style=\"color:#a31515\">&quot;class&quot;</span>, <span style=\"color:blue\">null</span>) == <span style=\"color:#a31515\">&quot;matchStyle&quot;</span> &amp;&amp;\r\n                                    lnks.InnerText.Trim().Length &gt; 0\r\n                              <span style=\"color:blue\">select</span> <span style=\"color:blue\">new</span>\r\n                              {\r\n                                  Text = lnks.InnerText\r\n                              };\r\n</pre>\r\n</div>\r\n<br></pre>\r\n<pre>But it didn't bring nothing. As it was the first time I put something on Descendants(), I removed it thinking about getting all &lt;td&gt; first and the I'd filter, but has some weird results.</pre>\r\n<pre>Is there any way to go directly where I want to and query the childs in a levels like <strong>&lt;table&gt;</strong> -&gt; <strong>&lt;tr&gt;</strong> -&gt; <strong>&lt;td&gt;</strong> -&gt; <strong>&lt;table&gt;</strong> -&gt; <strong>&lt;tr&gt;</strong> -&gt; <strong>&lt;td&gt;</strong> ?</pre>\r\n<pre><br></pre>\r\n<pre>Thanks a lot for the help and the developers for this amazing piece of software!</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-02-17T01:02:16.923-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "724109",
    "ThreadId": "246426",
    "Html": "<p>Did you solved your problem?</p>\r\n<p>&nbsp;</p>\r\n<p>I am facing the same problem where Descendants is not returning grandchildren nodes!!!!</p>\r\n<p>I am using now:</p>\r\n<pre style=\"font-family: Consolas; background: white; color: black; font-size: 13px;\">var&nbsp;tds=&nbsp;doc.DocumentNode.DescendantNodes().Where(n&nbsp;=&gt;&nbsp;n.Name.ToLower()&nbsp;==&nbsp;<span style=\"color: #a31515;\">\"td\"</span>);</pre>\r\n<pre style=\"font-family: Consolas; background: white; color: black; font-size: 13px;\">But maybe there is a better way?????</pre>\r\n<pre style=\"font-family: Consolas; background: white; color: black; font-size: 13px;\">Thanks,</pre>\r\n<pre style=\"font-family: Consolas; background: white; color: black; font-size: 13px;\">Nicolas\r\n</pre>",
    "PostedDate": "2012-01-12T01:02:34.61-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]