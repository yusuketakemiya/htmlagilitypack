[
  {
    "Id": "265336",
    "ThreadId": "77605",
    "Html": "<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>HtmlWeb hw = <span style=\"color:Blue\">new</span> HtmlWeb();\r\nFormProcessor p = <span style=\"color:Blue\">new</span> FormProcessor(hw);\r\n\r\n\r\n==&gt; Form this_form = p.GetForm(txtLink, <span style=\"color:#A31515\">&quot;/html[1]/body[1]/table[1]/tr[1]/td[2]/table[1]/tr[2]/td[1]/table[1]/tr[1]/td[1]/div[1]/div[1]/div[1]/table[1]/tr[1]/td[2]/form[1]&quot;</span>, FormQueryModeEnum.Nested);\r\n</pre>\r\n<pre><span style=\"color:#ff0000\">An unhandled exception of type 'System.MissingMethodException' occurred in HtmlAgilityPack.AddOns.FormProcessor.dll</span></pre>\r\n<pre><p><span style=\"color:#ff0000\">Additional information: <em>Method not found :translated from dutch)</em> HtmlNodeEnumerator HtmlAgilityPack.HtmlNodeCollection.GetEnumerator().</span></p><p>&nbsp;</p><p>&nbsp;</p><p>i keep getting the above error message, the xpath i found out by experimenting in the direct window of visual studio, so it should be good, i tried nested and adjecent, txtlink is referring to a</p><p>fqdn <a href=\"http://www.somesite.com/\">http://www.somesite.com/</a> (i tried with and without trailing slash)</p><p>&nbsp;</p><p>what can be wrong here</p></pre>\r\n</div>",
    "PostedDate": "2009-12-09T07:18:31.57-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "493546",
    "ThreadId": "77605",
    "Html": "<p>I've got the same issue</p>\r\n<p>I may have an idea: the addon FormProcessor has been released in 2006. At this time, HAP was V1.3.0</p>\r\n<p>nowaday it's V1.4.0. Did the method<span style=\"color:#ff0000\"><span style=\"color:#000000\"> HtmlAgilityPack.HtmlNodeCollection.GetEnumerator() disapeared between these two release ?</span><br></span></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-09-14T15:25:47.4-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "493680",
    "ThreadId": "77605",
    "Html": "<p>I've found a page describing the &quot;Getenumerator()&quot; method:</p>\r\n<p>http://www.kbs.uni-hannover.de/~minack/beagle++/beagle-0.0.13.2-doxygen/d6/dbf/classHtmlAgilityPack_1_1HtmlNodeCollection.html#41d4cdbf8efc35fe302c54870bd7623b</p>\r\n<p>but I don't know whitch version it is...</p>",
    "PostedDate": "2010-09-15T00:02:53.737-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "493787",
    "ThreadId": "77605",
    "Html": "<p>It says in the url HtmlAgilityPack 1_1 which I'm guessing is either HAP 1.1 or .NET 1.1</p>\r\n<p>The HtmlNodeEnumerator was removed in 1.4.0. Html Agility Pack used to explicitly implement the IEnumerator,IEnumerable,IList interfaces which requires quite a bit of code. This was a necessary evil back in the .NET 1.0/1.1 days. With .NET 2.0 List&lt;T&gt; and IList&lt;T&gt; were added which do more of the heavy lifting and are compatible with LINQ expressions. By switching over to using List&lt;T&gt; internally and exposing IList&lt;T&gt; code complexity was reduced while usability of the API was greatly increase. Looks like FormProcessor hasn't been updated. I wasn't even aware of it's existence until now.&nbsp;</p>\r\n<p>With the new version it looks like a bunch of things in FormProcessor could be cleaned up and updated.</p>\r\n<p>Version 1.3.0 is still available for download on codeplex, just scroll down the downloads list.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-09-15T05:37:58.24-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "495483",
    "ThreadId": "77605",
    "Html": "<p>Ok</p>\r\n<p>I've tried to use HAPv1.3.0.</p>\r\n<p>I tried like this:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> MyClass\r\n{\r\n        <span style=\"color:blue\">private</span> FormProcessor myFormProcessor;\r\n        <span style=\"color:blue\">private</span> HtmlDocument lastHtmlDocument;\r\n\r\n        <span style=\"color:blue\">public</span> MyClass()\r\n        {\r\n            myFormProcessor = <span style=\"color:blue\">new</span> FormProcessor();\r\n\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> HtmlDocument process(<span style=\"color:blue\">string</span> MyValue1, <span style=\"color:blue\">string</span> MyValue2)\r\n        {\r\n            HtmlDocument doc;\r\n\r\n            <span style=\"color:blue\">try</span>\r\n            {\r\n\r\n\r\n            Form form = myFormProcessor.GetForm(\r\n                <span style=\"color:#a31515\">&quot;http://www.MyWebSite.com&quot;</span>,\r\n                <span style=\"color:#a31515\">&quot;//form[@name='MyForm']&quot;</span>, FormQueryModeEnum.Nested);\r\n\r\n            form[<span style=\"color:#a31515\">&quot;MyInput1&quot;</span>].SetAttributeValue(<span style=\"color:#a31515\">&quot;value&quot;</span>, MyValue1);\r\n            form[<span style=\"color:#a31515\">&quot;MyInput2&quot;</span>].SetAttributeValue(<span style=\"color:#a31515\">&quot;value&quot;</span>, MyValue2);\r\n\r\n            doc = myFormProcessor.SubmitForm(form);\r\n\r\n            }\r\n            <span style=\"color:blue\">catch</span> (Exception e)\r\n            {\r\n                e.ToString();\r\n                <span style=\"color:blue\">return</span> <span style=\"color:blue\">null</span>;\r\n            }\r\n\r\n            <span style=\"color:blue\">return</span> doc;\r\n        }\r\n}\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>    <span style=\"color:blue\">class</span> Program\r\n    {\r\n        <span style=\"color:blue\">static</span> <span style=\"color:blue\">void</span> Main(<span style=\"color:blue\">string</span>[] args)\r\n        {\r\n            MyClass dummy = <span style=\"color:blue\">new</span> MyClass();\r\n\r\n            dummy.process(<span style=\"color:#a31515\">&quot;test&quot;</span>, <span style=\"color:#a31515\">&quot;test&quot;</span>);\r\n\r\n        }\r\n    }\r\n</pre>\r\n</div>\r\n<p>but it's bugging later at this method in HtmlAgilityPack.AddOns.FormProcessor :</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;summary&gt;</span>\r\n        <span style=\"color:gray\">///</span><span style=\"color:green\"> Gets the absolute URI.</span>\r\n        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;/summary&gt;</span>\r\n        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;param name=&quot;baseUri&quot;&gt;</span><span style=\"color:green\">The base URI.&lt;/param&gt;</span>\r\n        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;param name=&quot;path&quot;&gt;</span><span style=\"color:green\">The path.&lt;/param&gt;</span>\r\n        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;returns&gt;</span><span style=\"color:gray\">&lt;/returns&gt;</span>\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> Uri GetAbsoluteUri(Uri baseUri, <span style=\"color:blue\">string</span> path)\r\n        {\r\n            Uri uriTarget;\r\n            <span style=\"color:blue\">if</span> (Uri.TryCreate(path, UriKind.RelativeOrAbsolute, <span style=\"color:blue\">out</span> uriTarget))\r\n            {\r\n                <span style=\"color:green\">// See what type of URI it is...</span>\r\n                <span style=\"color:blue\">if</span> (uriTarget.IsAbsoluteUri)\r\n                {\r\n                    <span style=\"color:blue\">return</span> uriTarget;\r\n                }\r\n                <span style=\"color:blue\">else</span>\r\n                {\r\n                    <span style=\"color:green\">// Since it's not absolute, see whether it is relative to</span>\r\n                    <span style=\"color:green\">// the current directory, or points to the web server root</span>\r\n                    <span style=\"color:blue\">if</span> (uriTarget.OriginalString[0] == <span style=\"color:#a31515\">'/'</span>)\r\n                    {\r\n                        <span style=\"color:blue\">return</span> <span style=\"color:blue\">new</span> Uri(\r\n                            <span style=\"color:blue\">new</span> Uri(baseUri.Authority), // <span style=\"color:#ff0000\">Its bugging HERE ! </span><br>&nbsp;uriTarget.OriginalString.Substring(1));\r\n                    }\r\n                    <span style=\"color:blue\">else</span>\r\n                    {\r\n                        <span style=\"color:blue\">return</span> <span style=\"color:blue\">new</span> Uri(GetBaseUri(baseUri), uriTarget);\r\n                    }\r\n                }\r\n            }\r\n            <span style=\"color:blue\">else</span>\r\n            {\r\n                <span style=\"color:blue\">return</span> baseUri;\r\n            }\r\n        }\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Do someone know for fact that FormProcessor did ever worked with any version of HAP ?</p>\r\n<p>In this case, I'd like to know witch version of each dll.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-09-18T13:18:21.06-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "495684",
    "ThreadId": "77605",
    "Html": "<p>I've resolved the previous issue replacing</p>\r\n<pre><div style=\"color:black;background-color:white\"><pre><span style=\"color:blue\">return</span> <span style=\"color:blue\">new</span> Uri(<span style=\"color:blue\">new</span> Uri(baseUri.Authority),\r\n uriTarget.OriginalString.Substring(1));\r\n</pre>\r\n</div>\r\n</pre>\r\n<p>by</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>                        Uri uri1 = <span style=\"color:blue\">new</span> Uri(baseUri.AbsoluteUri, UriKind.Absolute); <span style=\"color:green\">//instead of Uri uri1 = new Uri(baseUri.Authority);</span>\r\n                        Uri uri2 = <span style=\"color:blue\">new</span> Uri( uri1 , uriTarget.OriginalString.Substring(1));\r\n                        <span style=\"color:blue\">return</span> uri2;\r\n</pre>\r\n</div>\r\n<p>Now I'm bloqued on this problem:</p>\r\n<p>the FromProcessor make a Loop (2 iterations)</p>\r\n<p>the first time,e the HTML result is the same html code than the first form (amazing!) with a &quot;OK&quot; status code</p>\r\n<p>the second, time the HTML result is empty, with this status code: &quot;(417) Expectation Failed.&quot;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-09-19T12:30:39.867-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]