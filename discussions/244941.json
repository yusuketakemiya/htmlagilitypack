[
  {
    "Id": "561821",
    "ThreadId": "244941",
    "Html": "\r\n<p></p>\r\n<div><span style=\"color:#000000\"><span style=\"font-size:x-small\">\r\n<p><span style=\"color:#000000\">Hi,</span></p>\r\n<p><span style=\"color:#000000\">I try to do some csv- and xls-downloads using HtmlAgilityPack. I Use the BrowserSession from &#65279;&#65279;&#65279;&#65279;&#65279;<span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><a href=\"http://refactoringaspnet.blogspot.com/2010/04/using-htmlagilitypack-to-get-and-post.html\">http://refactoringaspnet.blogspot.com/2010/04/using-htmlagilitypack-to-get-and-post.html</a>&nbsp;because\r\n it makes formprocessing really easy.</span></span></span></p>\r\n<p></p>\r\n<div><span style=\"color:#000000\">\r\n<p></p>\r\n<div>\r\n<div><span style=\"font-size:x-small\">\r\n<p><span style=\"font-size:x-small\">However, it's not possible to get a csv-response after a POST. HtmlWeb tries to parse the response as html, which obviously cannot succeed. So what I need is the raw response. Have a look at HtmlWeb.Get, line 1486:</span></p>\r\n</span></div>\r\n<p><span style=\"font-size:x-small; color:#0000ff\">Stream s = resp.GetResponseStream();<br>\r\n&#65279;string rawResponse = new StreamReader(s).ReadToEnd();</span></p>\r\n</div>\r\n<p></p>\r\n<span style=\"font-size:x-small\">\r\n<p><span style=\"font-size:x-small; color:#0000ff\">Stream s = resp.GetResponseStream();<br>\r\n&#65279;string rawResponse = new StreamReader(s).ReadToEnd();</span></p>\r\n</span></span></div>\r\n<p></p>\r\n<span style=\"color:#000000\"></span></span></span></div>\r\n<p></p>\r\n<p><span style=\"color:#000000\"><span style=\"font-size:x-small\"></p>\r\n<p></p>\r\n<p>It's possible to get the raw response here. Since I don't want to change your code, I tried using &#65279;HtmlWeb.PostResponseHandle. But HtmlWeb crashes then, because the response stream is already read.</p>\r\n<p></p>\r\n<p><span style=\"font-size:x-small\">&#65279;</span><span style=\"color:#0000ff\"><span style=\"font-size:x-small\">&#65279;</span><span style=\"color:#0000ff\">So any idea about how to get binary response data?</span></span></p>\r\n</span></span>\r\n<p></p>\r\n",
    "PostedDate": "2011-02-07T02:42:46.797-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "561834",
    "ThreadId": "244941",
    "Html": "\r\n<p>Hey,</p>\r\n<p>in the meantime I figured out that it works if I clone the stream (see &#65279;<span style=\"font-size:x-small\"><font size=\"2\"><a href=\"http://stackoverflow.com/questions/147941/how-can-i-read-an-http-response-stream-twice-in-c\">http:</a></font><font size=\"2\" color=\"#008000\"><font size=\"2\" color=\"#008000\">//stackoverflow.com/questions/147941/how-can-i-read-an-http-response-stream-twice-in-c</font></font></span><span style=\"font-size:x-small; color:#008000\"><span style=\"font-size:x-small; color:#008000\">).</span></span></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small; color:#008000\"><span style=\"font-size:x-small; color:#008000\">However, could anyone give me an advise, if HtmlAgilityPack is a good choice for this case?</span></span></span></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small; color:#008000\"><span style=\"font-size:x-small; color:#008000\">&nbsp;</span></span></span></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small; color:#008000\"><span style=\"font-size:x-small; color:#008000\">Thanks in advance.</span></span></span></p>\r\n<p><span style=\"font-size:x-small; color:#008000\"><span style=\"font-size:x-small; color:#008000\">&nbsp;</span></span></p>\r\n",
    "PostedDate": "2011-02-07T03:40:19.89-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]