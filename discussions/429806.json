[
  {
    "Id": "987691",
    "ThreadId": "429806",
    "Html": "\r\n<p>I need to parse form elements from a page that has two form tags one after another like so.</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">div</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;new&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">form</span> <span style=\"color:red\">action</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;http://xxx.xxx.com/y&quot;</span> <span style=\"color:red\">method</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;post&quot;</span> <span style=\"color:red\">enctype</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;multipart/form-data&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">input</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;hidden&quot;</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;hf1&quot;</span> <span style=\"color:red\">value</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;one&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">input</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;hidden&quot;</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;hf2&quot;</span> <span style=\"color:red\">value</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;new&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">input</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;file&quot;</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;file&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">button</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;submit&quot;</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;do&quot;</span>  <span style=\"color:red\">value</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;new image&quot;</span><span style=\"color:blue\">&gt;</span>new image<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">button</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">form</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">div</span><span style=\"color:blue\">&gt;</span>\r\n\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">div</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;done&quot;</span><span style=\"color:blue\">&gt;</span>\t\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">form</span> <span style=\"color:red\">action</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;http://xxx.xxx.com/y/&quot;</span> <span style=\"color:red\">method</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;post&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">input</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;hidden&quot;</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;hf1&quot;</span> <span style=\"color:red\">value</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;one&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">input</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;hidden&quot;</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;hf2&quot;</span> <span style=\"color:red\">value</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;done&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">button</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;submit&quot;</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;do&quot;</span> <span style=\"color:red\">value</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;Done with Images&quot;</span><span style=\"color:blue\">&gt;</span>done<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">button</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">form</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<pre>To check it i used the following code.</pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre>HtmlAgilityPack.HtmlDocument doc = <span style=\"color:blue\">new</span> HtmlAgilityPack.HtmlDocument();\r\nHtmlNode.ElementsFlags.Remove(<span style=\"color:#a31515\">&quot;form&quot;</span>);\r\n\r\ndoc.Load(<span style=\"color:blue\">new</span> StringReader(streamData));\r\n<span style=\"color:blue\">var</span> forms = doc.DocumentNode.Descendants(<span style=\"color:#a31515\">&quot;form&quot;</span>);\r\n\r\n<span style=\"color:blue\">var</span> count = 0;\r\n<span style=\"color:blue\">foreach</span> (<span style=\"color:blue\">var</span> form <span style=\"color:blue\">in</span> forms)\r\n{\r\n  <span style=\"color:blue\">foreach</span> (HtmlNode element <span style=\"color:blue\">in</span> form.SelectNodes(<span style=\"color:#a31515\">&quot;//input[@type='hidden']&quot;</span>))\r\n  {\r\n    <span style=\"color:blue\">if</span> (!element.Attributes.Contains(<span style=\"color:#a31515\">&quot;name&quot;</span>)) <span style=\"color:blue\">continue</span>;\r\n    System.Diagnostics.Debug.WriteLine(<span style=\"color:#a31515\">&quot;Form-&quot;</span> &#43; count.ToString() &#43; <span style=\"color:#a31515\">&quot; - Name: &quot;</span> &#43; element.Attributes[<span style=\"color:#a31515\">&quot;name&quot;</span>].Value &#43; <span style=\"color:#a31515\">&quot; - Value: &quot;</span> &#43; element.Attributes[<span style=\"color:#a31515\">&quot;value&quot;</span>].Value);\r\n  }\r\n  count&#43;&#43;;\r\n}\r\n</pre>\r\n<pre><p>The issue is each form seems to have the hidden elements of both forms, the output is</p><p>Form-0 - Name: hf1 - Value: one<br>Form-0 - Name: hf2 - Value: add<br>Form-0 - Name: hf1 - Value: one<br>Form-0 - Name: hf2 - Value: done<br>Form-1 - Name: hf1 - Value: one<br>Form-1 - Name: hf2 - Value: add<br>Form-1 - Name: hf1 - Value: one<br>Form-1 - Name: hf2 - Value: done</p><p>What I was expecting was</p><p>Form-0 - Name: hf1 - Value: one<br>Form-0 - Name: hf2 - Value: add<br>Form-1 - Name: hf1 - Value: one<br>Form-1 - Name: hf2 - Value: done</p><p>&nbsp;</p><p>I assume it has something to do with the two forms not having any name or id.<br>Any idea how fix this, FYI I do not have control over the page source.</p><p>&nbsp;</p><p>Regards</p><p>Al</p><p>&nbsp;</p><p>&nbsp;</p></pre>\r\n</div>\r\n</pre>\r\n",
    "PostedDate": "2013-01-16T09:57:59.863-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "991868",
    "ThreadId": "429806",
    "Html": "\r\n<p>Your getting all inputs each time as you are looking from the root path for all input elements.</p>\r\n<p><span style=\"font-size:10pt\">you need to look from the form onwards</span></p>\r\n<p><span style=\"font-size:10pt\">think its but couldn't check as not install on this machine..</span></p>\r\n<pre>form.SelectNodes(<span>&quot;./input[@type='hidden']&quot;</span>)</pre>\r\n<p>&nbsp;</p>\r\n<p>Lee</p>\r\n",
    "PostedDate": "2013-01-24T21:59:25.913-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "992437",
    "ThreadId": "429806",
    "Html": "\r\n<p>Thanks Lee,</p>\r\n<p>&nbsp;I'll give that a try.</p>\r\n<p>Al</p>\r\n",
    "PostedDate": "2013-01-26T08:47:17.287-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]