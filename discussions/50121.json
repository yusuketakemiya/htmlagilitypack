[
  {
    "Id": "167782",
    "ThreadId": "50121",
    "Html": "Hi,<br>\r\n<br>\r\nFirst post here so bear with me.<br>\r\n<br>\r\nI'm using the HTMLAgilityPack to scrape some data which I then want to place in a DataTable. The data i'm scraping comes in the form of a table with 3 columns. I want each row in the Datatable to correspond to each row in the HTML table. So here's where i've got so far and where i'm coming unstuck:<br>\r\n<br>\r\nThis code actually inserts the info I need into Col1 but then inserts the last record in the HTMLNodeCollection for Col2 and Col3 into all the rows.<br>\r\n<br>\r\nCan anybody point me in the right direction with this???<br>\r\n<br>\r\nThanks in advance<br>\r\nMark<br>\r\n<br>\r\n<span style=\"font-size:10px\">\r\n<p> </p>\r\n</span>\r\n<p><span style=\"font-size:10px;color:#2b91af\">DataTable</span><span style=\"font-size:10px\"> ssDT = </span><span style=\"font-size:10px;color:#0000ff\">new</span><span style=\"font-size:10px\"> </span><span style=\"font-size:10px;color:#2b91af\">DataTable</span><span style=\"font-size:10px\">();\r\n<p>ssDT.Columns.Add(</p>\r\n</span>\r\n<p><span style=\"font-size:10px;color:#a31515\">&quot;Col1&quot;</span><span style=\"font-size:10px\">, </span><span style=\"font-size:10px;color:#0000ff\">typeof</span><span style=\"font-size:10px\">(</span><span style=\"font-size:10px;color:#2b91af\">String</span><span style=\"font-size:10px\">));<br>\r\nssDT.Columns.Add(</span><span style=\"font-size:10px;color:#a31515\">&quot;Col2&quot;</span><span style=\"font-size:10px\">, </span><span style=\"font-size:10px;color:#0000ff\">typeof</span><span style=\"font-size:10px\">(</span><span style=\"font-size:10px;color:#2b91af\">String</span><span style=\"font-size:10px\">));<br>\r\nssDT.Columns.Add(</span><span style=\"font-size:10px;color:#a31515\">&quot;Col3&quot;</span><span style=\"font-size:10px\">, </span><span style=\"font-size:10px;color:#0000ff\">typeof</span><span style=\"font-size:10px\">(</span><span style=\"font-size:10px;color:#2b91af\">String</span><span style=\"font-size:10px\">));\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n</p>\r\n<p><span style=\"font-size:10px;color:#2b91af\">HtmlWeb</span><span style=\"font-size:10px\"> web = </span><span style=\"font-size:10px;color:#0000ff\">new</span><span style=\"font-size:10px\"> </span><span style=\"font-size:10px;color:#2b91af\">HtmlWeb</span><span style=\"font-size:10px\">();  \r\n<p>HtmlAgilityPack.</p>\r\n</span>\r\n<p><span style=\"font-size:10px;color:#2b91af\">HtmlDocument</span><span style=\"font-size:10px\"> doc = web.Load(&quot;</span><span style=\"font-size:10px;color:#a31515\">url&quot;</span><span style=\"font-size:10px\">);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n</p>\r\n<p>\r\n<p><span style=\"font-size:10px;color:#2b91af\">HtmlNodeCollection</span><span style=\"font-size:10px\"> col1Options = doc.DocumentNode.SelectNodes(</span><span style=\"font-size:10px;color:#a31515\">&quot;//td[@class=\\&quot;col1\\&quot;]&quot;</span><span style=\"font-size:10px\">);<br>\r\n</span><span style=\"font-size:10px;color:#2b91af\">HtmlNodeCollection</span><span style=\"font-size:10px\"> col2Options = doc.DocumentNode.SelectNodes(</span><span style=\"font-size:10px;color:#a31515\">&quot;//td[@class=\\&quot;col2\\&quot;]&quot;</span><span style=\"font-size:10px\">);<br>\r\n</span><span style=\"font-size:10px;color:#2b91af\">HtmlNodeCollection</span><span style=\"font-size:10px\"> col3Options = doc.DocumentNode.SelectNodes(</span><span style=\"font-size:10px;color:#a31515\">&quot;//td[@class=\\&quot;col3\\&quot;]&quot;</span><span style=\"font-size:10px\">);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n</p>\r\n<p>\r\n<p><span style=\"font-size:10px;color:#0000ff\">foreach</span><span style=\"font-size:10px\"> (</span><span style=\"font-size:10px;color:#2b91af\">HtmlNode</span><span style=\"font-size:10px\"> col1Option </span><span style=\"font-size:10px;color:#0000ff\">in</span><span style=\"font-size:10px\"> col2Options) <br>\r\n{<br>\r\n</span><span style=\"font-size:10px;color:#2b91af\">    DataRow</span><span style=\"font-size:10px\"> row = ssDT.NewRow();<br>\r\n    row[</span><span style=\"font-size:10px;color:#a31515\">&quot;Col1&quot;</span><span style=\"font-size:10px\">] = col1Option.InnerText;<br>\r\n    ssDT.Rows.Add(row); <br>\r\n}\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n</p>\r\n<p><span style=\"font-size:10px;color:#0000ff\">for</span><span style=\"font-size:10px\"> (</span><span style=\"font-size:10px;color:#0000ff\">int</span><span style=\"font-size:10px\"> i = 0; i &lt; col1Options.Count; i++) <br>\r\n{<br>\r\n</span><span style=\"font-size:10px;color:#0000ff\">    foreach</span><span style=\"font-size:10px\"> (</span><span style=\"font-size:10px;color:#2b91af\">HtmlNode</span><span style=\"font-size:10px\"> col2Option </span><span style=\"font-size:10px;color:#0000ff\">in</span><span style=\"font-size:10px\"> col2Options) <br>\r\n    {<br>\r\n        ss.Rows[i][</span><span style=\"font-size:10px;color:#a31515\">&quot;Col2&quot;</span><span style=\"font-size:10px\">] = col2Option.InnerText;<br>\r\n</span><span style=\"font-size:10px\">    } <br>\r\n    f</span><span style=\"font-size:10px;color:#0000ff\">oreach</span><span style=\"font-size:10px\"> (</span><span style=\"font-size:10px;color:#2b91af\">HtmlNode</span><span style=\"font-size:10px\"> col3option </span><span style=\"font-size:10px;color:#0000ff\">in</span><span style=\"font-size:10px\"> col3options) <br>\r\n    {<br>\r\n        ssDT.Rows[i][</span><span style=\"font-size:10px;color:#a31515\">&quot;Col3&quot;</span><span style=\"font-size:10px\">] = col3Option.InnerText; <br>\r\n</span><span style=\"font-size:10px\">    } <br>\r\n    ssDT.AcceptChanges(); <br>\r\n} <br>\r\n<br>\r\nGridView1.DataSource = ssDT;<br>\r\nGridView1.DataBind();</span> </p>\r\n",
    "PostedDate": "2009-03-13T08:06:37.223-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]