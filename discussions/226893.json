[
  {
    "Id": "492337",
    "ThreadId": "226893",
    "Html": "<div>My app retrieves &quot;Place names&quot; and their &quot;Addresses&quot; from a website.&nbsp;</div>\r\n<div>Here is the code so far:</div>\r\n<div>\r\n<pre><span></span><div style=\"color:black;background-color:white\"><pre><span style=\"color:blue\">Dim</span> content <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = <span style=\"color:#a31515\">&quot;&quot;</span>\r\n�� �<span style=\"color:blue\">Dim</span> web <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> HtmlAgilityPack.HtmlWeb\r\n�� �<span style=\"color:blue\">Dim</span> doc <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> HtmlAgilityPack.HtmlDocument()\r\n�� �doc.Load(WebBrowser1.DocumentStream)\r\n�� �<span style=\"color:blue\">Dim</span> hnc <span style=\"color:blue\">As</span> HtmlAgilityPack.HtmlNodeCollection = doc.DocumentNode.SelectNodes(<span style=\"color:#a31515\">&quot;//span[@class='listingTitle']&quot;</span>) <span style=\"color:green\">'//////Gets PlaceName/////////</span>\r\n�� �<span style=\"color:blue\">For</span> <span style=\"color:blue\">Each</span> link <span style=\"color:blue\">As</span> HtmlAgilityPack.HtmlNode <span style=\"color:blue\">In</span> hnc\r\n�� � � �<span style=\"color:blue\">Dim</span> replaceUnwanted <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = <span style=\"color:#a31515\">&quot;&quot;</span>\r\n�� � � �replaceUnwanted = link.InnerText.Replace(<span style=\"color:#a31515\">&quot;&amp;amp;&quot;</span>, <span style=\"color:#a31515\">&quot;&amp;&quot;</span>) <span style=\"color:green\">'</span>\r\n�� � � �replaceUnwanted = replaceUnwanted.Replace(<span style=\"color:#a31515\">&quot;'&quot;</span>, <span style=\"color:#a31515\">&quot;'&quot;</span>)\r\n�� � � �replaceUnwanted = replaceUnwanted.Replace(<span style=\"color:#a31515\">&quot;See full business details&quot;</span>, <span style=\"color:#a31515\">&quot;&quot;</span>)\r\n�� � � �replaceUnwanted = replaceUnwanted.ToLower().Replace(vbCrLf, <span style=\"color:#a31515\">&quot;&quot;</span>)\r\n\r\n�� � � �content &amp;= replaceUnwanted &amp; vbNewLine\r\n�� �<span style=\"color:blue\">Next</span>\r\n�� �RichTextBox1.Text = content\r\n�� �<span style=\"color:blue\">Me</span>.RichTextBox1.Lines = <span style=\"color:blue\">Me</span>.RichTextBox1.Text.Split(<span style=\"color:blue\">New</span> <span style=\"color:blue\">Char</span>() {ControlChars.Lf}, _\r\n�� � � � � � � � � � � � � � � � � � � � � � � StringSplitOptions.RemoveEmptyEntries)\r\n�� �<span style=\"color:blue\">Dim</span> content2 <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = <span style=\"color:#a31515\">&quot;&quot;</span>\r\n�� �<span style=\"color:blue\">Dim</span> doc2 <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> HtmlAgilityPack.HtmlDocument()\r\n�� �doc2.Load(WebBrowser1.DocumentStream)\r\n�� �<span style=\"color:blue\">Dim</span> hnc2 <span style=\"color:blue\">As</span> HtmlAgilityPack.HtmlNodeCollection = doc2.DocumentNode.SelectNodes(<span style=\"color:#a31515\">&quot;//div[@class='address']/text()[normalize-space(.)]&quot;</span>)<span style=\"color:green\">'//////Gets Address//////</span>\r\n�� � � �<span style=\"color:blue\">For</span> <span style=\"color:blue\">Each</span> link <span style=\"color:blue\">As</span> HtmlAgilityPack.HtmlNode <span style=\"color:blue\">In</span> hnc2\r\n�� � � � � �<span style=\"color:blue\">Dim</span> replaceUnwanted <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = <span style=\"color:#a31515\">&quot;&quot;</span>\r\n�� � � � � �replaceUnwanted = link.InnerText.Replace(<span style=\"color:#a31515\">&quot;&amp;amp;&quot;</span>, <span style=\"color:#a31515\">&quot;&amp;&quot;</span>)\r\n�� � � � � �replaceUnwanted = replaceUnwanted.Replace(<span style=\"color:#a31515\">&quot;'&quot;</span>, <span style=\"color:#a31515\">&quot;'&quot;</span>)\r\n�� � � � � �replaceUnwanted = link.InnerText.Replace(<span style=\"color:#a31515\">&quot;Map&quot;</span>, <span style=\"color:#a31515\">&quot;&quot;</span>)\r\n�� � � � � �replaceUnwanted = replaceUnwanted.Replace(<span style=\"color:#a31515\">&quot;Map&quot;</span>, <span style=\"color:#a31515\">&quot;&quot;</span>)\r\n�� � � � � �content2 &amp;= replaceUnwanted &amp; vbNewLine\r\n\r\n�� � � �<span style=\"color:blue\">Next</span>\r\n�� � � �RichTextBox2.Text = content2.Replace(ControlChars.Tab, <span style=\"color:#a31515\">&quot;&quot;</span>)\r\n�� � � �<span style=\"color:blue\">Me</span>.RichTextBox2.Lines = <span style=\"color:blue\">Me</span>.RichTextBox2.Text.Split(<span style=\"color:blue\">New</span> <span style=\"color:blue\">Char</span>() {ControlChars.Lf}, _\r\n�� � � � � � � � � � � � � � � � � � � � � � � � � StringSplitOptions.RemoveEmptyEntries)\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<div>So my app gets all the PlaceNames and puts them in richtextbox1 and gets all the addresses and puts them in richtextbox2. This would be perfect if yellowpages didnt have flaws,,, but they do. Some of their &quot;PlaceNames&quot; dont have &quot;Addresses&quot;.&nbsp;</div>\r\n<div>Eg:</div>\r\n<div><ol>\r\n<li>JH Ryder Machinery Limited</li>\r\n<li>Convenience Storage Ltd 3344 Rideau Rd, Gloucester, ON, K1G3N4 Map</li>\r\n<li>Regional Physiotherapy Clinic 1443 Woodroffe Ave, Nepean, ON, K2G1W1 Map</li>\r\n</ol></div>\r\n<div>So now there are more place names than addresses and they dont match up with each other. How can I make sure they always match up? Or any other workaround, like deleting/skipping &quot;PlaceNames&quot; without addresses.</div>\r\n<div>Here is the url if someone want to take a look at the html: <a href=\"http://www.yellowpages.ca/search/?stype=si&what=sh&where=Ottawa,+ON&x=0&y=0\">http://www.yellowpages.ca/search/?stype=si&amp;what=sh&amp;where=Ottawa,+ON&amp;x=0&amp;y=0</a></div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-09-11T14:21:54.997-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "493781",
    "ThreadId": "226893",
    "Html": "<p>&nbsp;</p>\r\n<p>1. select data which is relevant for ONE company and from that data (for example, you can load new HtmlDocument):</p>\r\n<p style=\"padding-left:30px\">a) extract company name</p>\r\n<p style=\"padding-left:30px\">b)extract address</p>\r\n<p>In this case You wont need to think which address match which company name.</p>",
    "PostedDate": "2010-09-15T05:23:03.967-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]