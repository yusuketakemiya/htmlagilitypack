[
  {
    "Id": "818491",
    "ThreadId": "350819",
    "Html": "\r\n<p>I'm trying to use the HTML Agility pack and PowerShell to get data from web-sites. The problem is that after I try to load the html through\r\n<span id=\"nsrTitle\">HtmlDocument.LoadHtml () or <span id=\"nsrTitle\">HtmlDocument<span><span>.</span></span>Load(filename)</span>&nbsp;</span>, the result is null. Here's a very simple example showing the problem:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:orangered\">$htmlstring</span> <span style=\"color:gray\">=</span> @'\r\n&lt;html<span style=\"color:gray\">&gt;</span>\r\n\t&lt;head<span style=\"color:gray\">&gt;</span>\r\n\t\t&lt;title<span style=\"color:gray\">&gt;</span>The new way&lt;<span style=\"color:gray\">/</span>title<span style=\"color:gray\">&gt;</span>\r\n\t\r\n\t&lt;<span style=\"color:gray\">/</span>head<span style=\"color:gray\">&gt;</span> &lt;body<span style=\"color:gray\">&gt;</span>\r\nThis is a  test \r\n\t\t&lt;<span style=\"color:gray\">/</span>body<span style=\"color:gray\">&gt;</span>\r\n&lt;<span style=\"color:gray\">/</span>html<span style=\"color:gray\">&gt;</span>\r\n'@\r\nadd<span style=\"color:gray\">-</span>type <span style=\"color:gray\">-</span>Path E:\\prof\\computing\\Web\\HtmlAgilityPack.1.4.0\\HtmlAgilityPack.dll \r\n<span style=\"color:orangered\">$doc</span> <span style=\"color:gray\">=</span> New<span style=\"color:gray\">-</span>Object HtmlAgilityPack.HtmlDocument \r\n<span style=\"color:orangered\">$result</span> <span style=\"color:gray\">=</span> <span style=\"color:orangered\">$doc</span>.LoadHtml(<span style=\"color:orangered\">$htmlstring</span>) \r\n<span style=\"color:blue\">if</span> (<span style=\"color:orangered\">$result</span> <span style=\"color:gray\">-eq</span> <span style=\"color:orangered\">$null</span>) {<span style=\"color:#a31515\">&quot;null returned&quot;</span>}<span style=\"color:blue\">else</span>{<span style=\"color:#a31515\">&quot;non-null return&quot;</span>}\r\n</pre>\r\n</div>\r\nThis results in the message &quot;null returned&quot;.\r\n<p></p>\r\n<p>&nbsp;I thought I had this working but even my test data html files aren't loading now.</p>\r\n<p>I've been using PowerGui (now v3.2) for most of my development but the example produces exactly the same results when run on PowerShell ISI.</p>\r\n<p>&nbsp;</p>\r\n<p>Any ideas?</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks</p>\r\n<p>&nbsp;</p>\r\n<p>Mike</p>\r\n",
    "PostedDate": "2012-04-01T16:05:20.513-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]