[
  {
    "Id": "1279344",
    "ThreadId": "554657",
    "Html": "Hello, \r<br />\n<br />\nI am a complete novice to XPath and the HtmlAgilityPack. Please help me understand how to gather HTML content. Here is my code: <br />\n<pre><code>    static void Main(string[] args) \n    { \n      string input = @&quot; \n&lt;span style=&quot;&quot;font-style: italic&quot;&quot;&gt;This is the title&lt;/span&gt;. \nThis is the introductory text: \n&lt;ol&gt; \n  &lt;li&gt;List Item One&lt;/li&gt; \n  &lt;li&gt;List Item Two&lt;/li&gt; \n  &lt;li&gt;List Item Three&lt;/li&gt; \n  &lt;li&gt;This list item is nested: \n      &lt;ol&gt; \n        &lt;li&gt;List Item Four A.&lt;/li&gt; \n        &lt;li&gt;List Item Four B.&lt;/li&gt; \n      &lt;/ol&gt; \n      Yes it is. \n  &lt;/li&gt; \n  &lt;li&gt;List Item Five&lt;/li&gt; \n&lt;/ol&gt; \nThis is the footer text. Last updated: July 20, 2014 \n\n&quot;; \n\n      HtmlDocument doc = new HtmlDocument(); \n\n      try \n      { \n        doc.LoadHtml(input); \n      } \n      catch (Exception e) \n      { \n        LogIt(&quot;ERROR: &quot; + e.Message); \n        return; \n      } \n\n      HtmlNode get_title = doc.DocumentNode.SelectSingleNode(&quot;//span&quot;); \n      if (get_title != null) \n      { \n        LogIt(&quot;Title: '&quot; + get_title.InnerHtml + &quot;'&quot;); \n      } \n\n      HtmlNodeCollection get_outer_lists = doc.DocumentNode.SelectNodes(&quot;//ol//li&quot;); \n\n      if (get_outer_lists != null) \n      { \n        foreach (HtmlNode hn_outer in get_outer_lists)  \n        { \n          LogIt(&quot;Begin outer for&quot;); \n          LogIt(&quot;outer HTML: '&quot; + hn_outer.OuterHtml + &quot;'&quot;); \n\n          // Now fetch inner list, the text above the inner list, and the  \n          // text below the inner list. \n\n          HtmlNodeCollection get_inner_lists = doc.DocumentNode.SelectNodes(&quot;//ol//li//ol//li&quot;); \n\n          if (get_inner_lists != null) \n          { \n            foreach (HtmlNode hn_inner in get_inner_lists) \n            { \n              LogIt(&quot;\\tinner HTML: '&quot; + hn_inner.OuterHtml + &quot;'&quot;); \n            } \n          } \n          else \n          { \n            LogIt(&quot;ERROR: Could not get inner list&quot;); \n          } \n        } \n      } \n      else \n      { \n        LogIt(&quot;ERROR: Could not select //ol//li&quot;); \n        Console.Read(); \n        return; \n      } \n\n      Console.Read(); \n      return; \n    } \n\n    private static void LogIt(string str) \n    { \n      Console.WriteLine(str); \n       \n      return; \n    } \n</code></pre>\n\n...and here is my output:<br />\n<pre><code>Title: 'This is the title' \nBegin outer for \nouter HTML: '&lt;li&gt;List Item One&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four A.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four B.&lt;/li&gt;' \nBegin outer for \nouter HTML: '&lt;li&gt;List Item Two&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four A.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four B.&lt;/li&gt;' \nBegin outer for \nouter HTML: '&lt;li&gt;List Item Three&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four A.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four B.&lt;/li&gt;' \nBegin outer for \nouter HTML: '&lt;li&gt;This list item is nested: \n      &lt;ol&gt; \n        &lt;li&gt;List Item Four A.&lt;/li&gt; \n        &lt;li&gt;List Item Four B.&lt;/li&gt; \n      &lt;/ol&gt; \n      Yes it is. \n  &lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four A.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four B.&lt;/li&gt;' \nBegin outer for \nouter HTML: '&lt;li&gt;List Item Four A.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four A.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four B.&lt;/li&gt;' \nBegin outer for \nouter HTML: '&lt;li&gt;List Item Four B.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four A.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four B.&lt;/li&gt;' \nBegin outer for \nouter HTML: '&lt;li&gt;List Item Five&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four A.&lt;/li&gt;' \n        inner HTML: '&lt;li&gt;List Item Four B.&lt;/li&gt;' \n</code></pre>\n\nQuestions: <br />\n<ol>\n<li>I can get the title text just fine, but how do I get the introductory text or the footer? They don't belong to an HTML element I can select. </li>\n<li>\nThe outer foreach loop iterates through both the outer and the inner ordered lists. How do I change the XPath string so that the outer for loop only iterates through the outer list? The inner for loop should take care of the inner list. <br />\n</li>\n</ol>\n",
    "PostedDate": "2014-07-30T15:00:34.12-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1279345",
    "ThreadId": "554657",
    "Html": "The subject should say &quot;Need help with SelectNodes&quot;, not &quot;Need help with SelectBodes&quot;.<br />\n",
    "PostedDate": "2014-07-30T15:01:57.607-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1321816",
    "ThreadId": "554657",
    "Html": "Not sure if you need help with this any more, but I figured I'd answer since it should be easy enough to fix.<br />\n<ol>\n<li>For text that is not entirely within an html tag like the introductory text or footer, you will look for a node that has name=&quot;#text&quot;.  These types of nodes correspond with exactly the situation you are talking about.</li>\n<li>\nThe &quot;//&quot; xpath operator searches for any descendant of the current node.  Therefore, &quot;//ol//li&quot; will match every single &lt;ol&gt; throughout the document.  I would do something more like this: &quot;/ol/li&quot;.  This matches any top level ol, and li's immediately underneath it.  (Your original would get all li's (even from the second level list) underneath the &lt;ol&gt;.  It would also grab embedded &lt;ol&gt;'s.    Rather than do the xpath from the top level as you are attempting to do for the inner lists, you should use the outer list node as the starting point.  Your code should be something more like this (only selection code displayed here):<br />\n</li>\n</ol>\n<pre><code>HtmlNodeCollection get_outer_lists = doc.DocumentNode.SelectNodes(&quot;/ol/li&quot;); \n\nforeach (HtmlNode hn_outer in get_outer_lists)  \n{\n\n          HtmlNodeCollection get_inner_lists = hn_outer.SelectNodes(&quot;./ol/li&quot;);\n\n}\n\n\n</code></pre>\n\n",
    "PostedDate": "2014-11-13T08:16:36.94-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]