[
  {
    "Id": "992190",
    "ThreadId": "430886",
    "Html": "\r\n<p>I've been parsing out a page and I've reach a point where I'm stuck. I'm looking at a two column table and I just want the specific row containing the word &quot;Earnings date&quot; to be returned. Right now, I get all the rows. I'm attach the out put below. Is there\r\n a way to then convert it to a datable? thanks for your help in advance.</p>\r\n<pre>var infoNode = document.DocumentNode.SelectSingleNode(&quot;//table[@class='snapshot-table2']&quot;);\r\n\r\nvar rows = infoNode.SelectNodes(&quot;//tr[@class='table-dark-row']&quot;);\r\nvar data = infoNode.SelectNodes(&quot;//td[@body='snapshot-td2-cp']&quot;);\r\n\r\n foreach (HtmlNode row in rows) {\r\n                if (row.InnerText.Contains(&quot;Earnings&quot;)) {\r\n                    earningsdate = row.InnerHtml.ToString();\r\n                    var result = row.SelectNodes(&quot;//td&quot;);\r\n\r\n                }\r\n            }</pre>\r\n<pre><div style=\"background-color:white; color:black\"><pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">width</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;7%&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;snapshot-td2-cp&quot;</span> <span style=\"color:red\">align</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;left&quot;</span> <span style=\"color:red\">title</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;cssbody=[tooltip_short_bdy] cssheader=[tooltip_short_hdr] body=[Long Term Debt to Equity (mrq)] offsetx=[10] offsety=[20] delay=[300]&quot;</span><span style=\"color:blue\">&gt;</span>LT Debt/Eq<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">width</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;8%&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;snapshot-td2&quot;</span> <span style=\"color:red\">align</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;left&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span>0.31<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">width</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;7%&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;snapshot-td2-cp&quot;</span> <span style=\"color:red\">align</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;left&quot;</span> <span style=\"color:red\">title</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;cssbody=[tooltip_short_bdy] cssheader=[tooltip_short_hdr] body=[Earnings date<br><br>BMO = Before Market Open AMC = After Market Close] offsetx=[10] offsety=[20] delay=[300]&quot;</span><span style=\"color:blue\">&gt;</span>Earnings<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">width</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;8%&quot;</span> <span style=\"color:red\">class</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;snapshot-td2&quot;</span> <span style=\"color:red\">align</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;left&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span>Feb 18<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">b</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n\r\n</pre>\n</div>\n</pre>\r\n",
    "PostedDate": "2013-01-25T10:40:55.25-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "992248",
    "ThreadId": "430886",
    "Html": "\r\n<p>Think I have it working, below is what I ended up using:</p>\r\n<p>&nbsp;</p>\r\n<pre>        private static DataTable ParseTable(HtmlNode table)\r\n        {\r\n            var result = new DataTable();\r\n\r\n            var rows = table.Descendants(&quot;tr&quot;);\r\n\r\n            result.Columns.Add(new DataColumn(&quot;Title&quot;, typeof(string)));\r\n            result.Columns.Add(new DataColumn(&quot;Value&quot;, typeof(string)));\r\n\r\n\r\n            foreach (var row in rows.Skip(1))\r\n            {\r\n                var data = new List();\r\n                int x = 1;\r\n\r\n                foreach (var column in row.Descendants(&quot;td&quot;))\r\n                {\r\n                    data.Add(column.InnerText);\r\n                    if (x == 2)\r\n                    {\r\n                        result.Rows.Add(data.ToArray());\r\n                        x = 0;\r\n                        data.Clear();\r\n                    }\r\n\r\n                    x++;\r\n                }\r\n                \r\n            }\r\n            return result;\r\n        }</pre>\r\n",
    "PostedDate": "2013-01-25T13:44:17.487-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]