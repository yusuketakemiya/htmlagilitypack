[
  {
    "Id": "1298751",
    "ThreadId": "565113",
    "Html": "Hi All,<br />\n<pre><code>     I need to parse inner HTML tables from a web page and I am using HTML Agility pack for it. Here is my HTML table and C# code.</code></pre>\n\nHere is the issue. I have 3 Inner HTML tables.\r<br />\n<br />\n1st Inner table - 3 rd level\r<br />\n2 nd HTML table  - 3 rd level\r<br />\n3 rd HTML table - 2 nd Level\r<br />\n<br />\nWhen looping through the Main HTML table, it has to stop at the third level and has to populate the DataTable as there is the first inner table. But instead it's going to the next level and populating the table.\r<br />\n<br />\nSame thing with the 2 nd table.\r<br />\n<br />\nFor 3 HTML table, it has to come out the 3 rd loop and has to populate the DataTable.\r<br />\n<br />\nCan someone guide me, where exactly i ma doing mistake in my code and what is the error.<br />\n&lt;table&gt;\t\t\t\r\n &lt;tr&gt;\r\n \t&lt;td&gt;\r\n \t&lt;table&gt;\r\n\t\t&lt;tr&gt;\r\n\t\t\t&lt;td&gt;\r\n\t\t\t\t&lt;table&gt;\r\n\t\t\t\t\t&lt;tr&gt;\r\n\t\t\t\t\t&lt;td&gt;&lt;b&gt;Daily Backup Failed Client Report - Corporate&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;\r\n\t\t\t\t\t&lt;/tr&gt;\r\n\t\t\t\t&lt;/table&gt;\r\n\t\t\t&lt;/td&gt;\r\n\t\t\t&lt;td&gt;\r\n\t\t\t\t&lt;table&gt;\r\n\t\t\t\t\t&lt;tr&gt;\r\n\t\t\t\t\t&lt;td&gt;Last Day: 8/28/14 09:06 - 8/29/14 09:06&lt;/td&gt;\r\n\t\t\t\t\t&lt;/tr&gt;\r\n\t\t\t\t\t&lt;tr&gt;\r\n\t\t\t\t\t&lt;td&gt;NetBackup Master and Media Servers&lt;/td&gt;\r\n\t\t\t\t\t&lt;/tr&gt;\r\n\t\t\t\t&lt;/table&gt;\r\n\t\t\t&lt;/td&gt;\r\n\t\t&lt;/tr&gt;\r\n\t&lt;/table&gt;\r\n\t&lt;/td&gt;\r\n&lt;/tr&gt;\t\t\r\n&lt;tr&gt;\r\n\t&lt;td&gt;\r\n\t&lt;!-------------------- the actual table ------------------------&gt;\r\n\t&lt;table&gt;\r\n\t\t&lt;tr&gt;\r\n\t\t\t\t&lt;td&gt;1&lt;/td&gt;\r\n\t\t\t\t&lt;td&gt;2&lt;/td&gt;\r\n\t\t\t\t&lt;td&gt;3&lt;/td&gt;\r\n\t\t&lt;/tr&gt;\r\n\t\t&lt;tr&gt;\r\n\t\t\t\t&lt;td&gt;1&lt;/td&gt;\r\n\t\t\t\t&lt;td&gt;2&lt;/td&gt;\r\n\t\t\t\t&lt;td&gt;3&lt;/td&gt;\r\n\t\t&lt;/tr&gt;\r\n\t\t&lt;tr&gt;\r\n\t\t\t\t&lt;td&gt;1&lt;/td&gt;\r\n\t\t\t\t&lt;td&gt;2&lt;/td&gt;\r\n\t\t\t\t&lt;td&gt;3&lt;/td&gt;\r\n\t\t&lt;/tr&gt;\r\n\t\t&lt;tr&gt;\r\n\t\t\t\t&lt;td&gt;1&lt;/td&gt;\r\n\t\t\t\t&lt;td&gt;2&lt;/td&gt;\r\n\t\t\t\t&lt;td&gt;3&lt;/td&gt;\r\n\t\t&lt;/tr&gt;\r\n\r\n\t&lt;/table&gt;\r\n\t&lt;/td&gt;\r\n&lt;/tr&gt;\r\n\t\r\n&lt;tr&gt;\r\n\t&lt;td&gt;&lt;br&gt;&lt;hr&gt;Generated by Data Protection Advisor v6.1.0 (Build 85670)&lt;br&gt;Date: 8/29/14 09:08&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/table&gt;\r\n<pre><code>                foreach (HtmlNode table in doc.DocumentNode.SelectNodes(&quot;//table&quot;))\n                {\n                    ///This is the table.\n                    foreach (HtmlNode row in table.SelectNodes(&quot;tr&quot;).Skip(1))\n                    {\n                        ///This is the row.\n                       foreach (HtmlNode cell in row.SelectNodes(&quot;td&quot;))\n                         ///can also use &quot;th|td&quot;, but right now we ONLY need td\n                         {\n                             //This is the cell.\n                            if (cell.InnerHtml.Contains(&quot;table&quot;))\n                             {\n                                 foreach (HtmlNode subtable in cell.SelectNodes(&quot;//table&quot;))\n                                 {\n                                     foreach (HtmlNode subrow in subtable.SelectNodes(&quot;tr&quot;).Skip(1))\n                                     {\n                                         foreach (HtmlNode subcell in subrow.SelectNodes(&quot;td&quot;))\n                                         {\n                                             if (subcell.InnerHtml.Contains(&quot;table&quot;))\n                                             {\n                                                 foreach (HtmlNode subsubtable in subcell.SelectNodes(&quot;//table&quot;))\n                                                 {\n                                                     foreach (HtmlNode subsubrow in subsubtable.SelectNodes(&quot;tr&quot;).Skip(1))\n                                                     {\n                                                         foreach (HtmlNode subsubcell in subsubrow.SelectNodes(&quot;td&quot;))\n                                                         {\n                                                             if (subsubcell.InnerHtml.Contains(&quot;table&quot;))\n                                                             {\n                                                                 foreach (HtmlNode subsubsubtable in subsubcell.SelectNodes(&quot;//table&quot;))\n                                                                 {\n                                                                     foreach (HtmlNode subsubsubrow in subsubsubtable.SelectNodes(&quot;tr&quot;).Skip(1))\n                                                                     {\n                                                                         foreach (HtmlNode subsubsubcell in subsubsubrow.SelectNodes(&quot;td&quot;))\n                                                                         {                                                                              \n                                                                             dccc.Columns.Add(subsubcell.InnerText);\n                                                                             dataGridView1.DataSource = dccc;\n                                                                         }\n\n                                                                     }\n                                                                 }\n                                                             }\n                                                             else\n                                                             {\n                                                                 if (dm1.Rows.Count == 0)\n                                                                 {\n                                                                     dm1.Columns.Add(subsubcell.InnerText);\n                                                                     dataGridView1.DataSource = dm1;\n                                                                 }\n                                                                 else \n                                                                 {\n                                                                     dm2.Columns.Add(subsubcell.InnerText);\n                                                                     dataGridView1.DataSource = dm2;                                                                     \n                                                                 }                                       \n                                                             }\n                                                         }                                                           \n                                                     }\n                                                     dc.Columns.Add(subcell.InnerText);\n                                                     dataGridView2.DataSource = dc;\n                                                 }\n                                             }\n                                             else\n                                             {\n                                                 dm1.Columns.Add(subcell.InnerText);\n                                                 dataGridView1.DataSource = dm1;                                                    \n                                             }\n                                         }\n                                     }\n                                 }\n                             }\n                             else\n                             {                                     \n                                 dmm.Columns.Add(cell.InnerText);\n                             }\n                         }\n                     }\n                 }</code></pre>\n\n",
    "PostedDate": "2014-09-03T14:12:26.963-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]